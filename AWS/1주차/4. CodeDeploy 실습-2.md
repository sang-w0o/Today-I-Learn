# `AWS CodeDeploy 실습-2`

새로운 유저를 생성하여 로컬에서 개발한 코드를 S3가 받아서 CodeDeploy가 배포하도록 하는 코드 파이프라인을 구성 해보겠습니다. 다시 IAM 으로 들어가겠습니다. 

![스크린샷 2021-03-08 오후 4 09 50](https://user-images.githubusercontent.com/45676906/110286745-c493cd80-8028-11eb-86e1-bdbf848408be.png)

새로운 유저를 추가하겠습니다. 

![스크린샷 2021-03-08 오후 4 11 13](https://user-images.githubusercontent.com/45676906/110286879-f9078980-8028-11eb-8855-ee38644c46a9.png)

위와 같이 `엑세스 유형을 프로그래밍 방식 엑세스`를 선택합니다. 그리고 `엑세스 키 ID`와 `비밀 엑세스 키 ID`를 받아 Console 에서 AWS 리소스를 접근할 수 있습니다. 

<img width="1792" alt="스크린샷 2021-03-08 오후 4 13 18" src="https://user-images.githubusercontent.com/45676906/110287059-44ba3300-8029-11eb-8bc6-1c96536aecd1.png">

![스크린샷 2021-03-08 오후 4 14 30](https://user-images.githubusercontent.com/45676906/110287169-687d7900-8029-11eb-8845-a3424f31deed.png)

위와 같이 `CodeDeployFullAccess`와 `S3FullAccess`를 체크한 후에 다음을 누르겠습니다. 그리고 계속 다음을 눌러 사용자를 만들겠습니다. 
 
![스크린샷 2021-03-08 오후 4 16 01](https://user-images.githubusercontent.com/45676906/110287340-ac707e00-8029-11eb-9c77-dfba5b355f8d.png)

위와 같이 `엑세스 키 ID`와 `비밀 엑세스 키 ID`가 추가된 것을 볼 수 있습니다. 

`그리고 로컬 터미널로 가겠습니다.`

```
curl "https://s3.amazonaws.com/aws-cli/awscli-bundle.zip" -o "awscli-bundle.zip"
unzip awscli-bundle.zip
sudo ./awscli-bundle/install -i /usr/local/aws -b /usr/local/bin/aws
aws configure
```

<img width="285" alt="스크린샷 2021-03-08 오후 4 33 04" src="https://user-images.githubusercontent.com/45676906/110289063-3d485900-802c-11eb-9f5e-f6b824fa25ea.png">

그러면 위와 같이 `엑세스 키 ID`와 `비밀 엑세스 키 ID`를 입력하라는 창이 나옵니다.

- `Default region namae [None]`: ap-northeast-2
- `Dafult output format: [None]`: Enter
 
<br>

## `S3 버킷 만들기`

![스크린샷 2021-03-07 오전 12 36 09](https://user-images.githubusercontent.com/45676906/110212106-26dfb780-7edd-11eb-851f-e6f6a7c9f98b.png)

![스크린샷 2021-03-07 오전 12 37 03](https://user-images.githubusercontent.com/45676906/110212132-4a0a6700-7edd-11eb-8dc9-6fae61018c67.png)

![스크린샷 2021-03-07 오전 12 39 17](https://user-images.githubusercontent.com/45676906/110212217-a79eb380-7edd-11eb-90fa-b114f529070a.png)

그리고 나머지는 그대로 두고 버킷을 만들겠습니다. 

<br>

## `CodeDeploy 애플리케이션 만들기`

먼저 로컬 터미널에서 아래의 명렁어를 입력하겠습니다. 

```
aws deploy create-application --application-name 애플리케이션이름(성공이라면 applicationId가 생성되었을 것입니다.)
aws deploy push --application-name 애플리케이션이름 --s3-location s3://버킷이름/애플리케이션이름.zip --ignore-hidden-files
```

<br>

### `CodeDeploy 배포그룹 만들기`

![스크린샷 2021-03-08 오후 5 01 56](https://user-images.githubusercontent.com/45676906/110292067-083e0580-8030-11eb-8144-ef05b404b0f5.png)

![스크린샷 2021-03-08 오후 5 03 42](https://user-images.githubusercontent.com/45676906/110292413-826e8a00-8030-11eb-90db-d9f9b09d2ab6.png)

<img width="804" alt="스크린샷 2021-03-08 오후 5 03 53" src="https://user-images.githubusercontent.com/45676906/110292476-a205b280-8030-11eb-8c8c-5fcedee297df.png">

![스크린샷 2021-03-08 오후 5 05 07](https://user-images.githubusercontent.com/45676906/110292538-c1044480-8030-11eb-85d0-83f6e2027411.png)

위와 같이 설정한 후에 `배포 그룹 생성`을 누르겠습니다. 

![스크린샷 2021-03-08 오후 5 08 09](https://user-images.githubusercontent.com/45676906/110292676-ee50f280-8030-11eb-988b-f5bd56e54de8.png)

![스크린샷 2021-03-08 오후 5 08 19](https://user-images.githubusercontent.com/45676906/110292701-fad54b00-8030-11eb-8e3b-290436d25c85.png)

위와 같이 선택한 후에 `배포 만들기`를 누르겠습니다. 

