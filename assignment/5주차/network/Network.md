# `네트워크 계층의 역할`

![osi](https://media.vlpt.us/images/xldksps4/post/980fe5d0-fcfe-4395-9148-0a110475ba26/image.png)

이번 글에서는 OSI 7 Layer에서 `3계층에 해당하는 네트워크 계층`에 대해서 알아보겠습니다. 

네트워크 계층은 이름에서 어느정도 유추할 수 있듯이 `서로 다른 네트워크에 있는 목적지로 데이터를 전송하기 위해 필요한 계층`입니다. 
이 계층을 통해 다른 네트워크로 데이터를 전송하려면 `라우터(router)`라는 네트워크 장비가 필요합니다. 

<br>

### `라우터란 무엇일까요?`

간단하게 말하면 데이터의 목적지가 정해지면 `해당 목적지까지 어떤 경로로 가는 것이 좋은지`를 알려주는 기능을 합니다. 

하지만 목적지로 데이터를 전송하려면 `상대가 어디에 있는지를 알아야` 전송할 수가 있습니다. 택배나 우편의 경우 처럼..
그러면 현실에서 사용하는 주소처럼 `네트워크에도 주소`라는 개념이 있습니다. 이렇게 `네트워크를 식별할 수 있는 다른 주소가 필요합니다.` 그 주소를 `IP 주소`라고 합니다.

<br>

### `IP 주소란?`

간단하게 정리하면 `어떤 네트워크의 어떤 컴퓨터인지`를 구분할 수 있도록 하는 주소입니다. IP 주소가 있으면 다른 네트워크에 있는 목적지를 지정할 수 있습니다. 

IP 주소로 목적지를 지정하는 것뿐만 아니라 데이터를 `어떤 경로`로 보낼지도 결정해야 합니다. 목적지 IP 주소까지 어떤 경로로 데이터를 보낼지 결정하는 것을 `라우팅`이라고 합니다.

<br>

### `IP란?`

위의 그림에서 네트워크 계층에는 `IP(Internet Protocol) 프로토콜`이 존재합니다. 

![cap](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FbOhDdj%2FbtquzF10dfu%2FWouHYOmk3m0joNhrtabAzK%2Fimg.png)

위와 같은 구조로 `캡슐화`, `역캡슐화`가 진행됩니다. 네트워크 계층에서는 IP 헤더를 추가합니다. IP 헤더에는 정말 많은 것들이 들어있지만 지금은 `출발지 IP 주소`, `목적지 IP 주소`가 들어있다 정도를 기억하겠습니다. 

이렇게 `데이터에 IP 헤더가 추가되는데, 이렇게 만들어진 것을 IP 패킷`이라고 합니다. 

<br>

### `IP 주소의 구조`

IP 버전에는 `IPv4`와 `IPv6`가 있습니다. 

- `IPv4는 32비트로 되어 있어서 IP 주소를 약 43억 개를 만들 수 있습니다.`
- `IPv6는 128비트로 되어 있어서 IPv4 주소 보다 많은 IP 주소를 만들 수 있습니다.`

예전에 `IPv4`를 만들 때만 해도 43억개면 충분하다 생각했지만 현재는 IP 주소가 부족해져서 `IPv6`가 새로 나오게 되었습니다. 

그리고 IP 주소에는 `공인 IP 주소`, `사설 IP 주소`가 있습니다.(공인 IP 주소는 ISP가 제공합니다.) IP 주소에 두 종류가 필요한 이유가 무엇일까요?

위에서 말했던 것처럼 IP 주소가 고갈되고 있기에 모든 컴퓨터에 `공인 IP`를 부여하기에는 쉽지 않습니다. 
즉, `인터넷에 직접 연결되는 컴퓨터나 라우터에는 공인 IP 주소를 할당`하고 `회사나 가정의 랜에 있는 컴퓨터는 사설 IP 주소를 할당`하는 정책을 사용하고 있습니다.

![q12121212](https://user-images.githubusercontent.com/45676906/112945247-00750b00-916f-11eb-8eab-bca078ec2094.jpeg)

현재 집에서 공유기를 사용하는 모습이 위와 같다고 생각하면 될 거 같습니다. 

IP 주소는 32비트로 되어 있습니다. 하지만 사람들이 이해하기 쉽게 10진수로 표시하지만 실제로는 2진수로 되어 있습니다. 

```
11000000 | 10101000 | 00000001 | 00001010 
```

위와 같이 IP는 총 32비트의 2진수로 이루어져있습니다. 2진수를 10진수로 변경해보겠습니다. 

```
192.168.1.12
``` 

위와 같이 우리가 흔히 보는 IP 주소의 형태는 2진수로를 10진수의 형태로 바꾼 것입니다. 즉, `8비트의 2진수이기 때문에 10진수의 범위는 0 ~ 255 입니다.`

그리고 IP 주소는 `네트워크 ID`와 `호스트 ID`로 나눠져 있습니다. 

- `네트워크 ID: 어떤 네트워크 인지를 나타냅니다.`
- `호스트 ID: 해당 네트워크의 어느 컴퓨터 인지를 나타냅니다.`
