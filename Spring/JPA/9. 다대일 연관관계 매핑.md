# `다대일 연관관계 매핑`

## `연관관계 메핑시 고려사항 3가지`

- 다중성

- 단방향, 양방향

- 연관관계의 주인

<br>

## `다중성`

- 다대일: `@ManyToOne`

- 일대다: `@OneToMany`

- 일대일: `@OneToOne`

- 다대다: `@ManyToMany` (실무에서 사용하면 안된다고 함..)

<br>

## `단방향, 양방향`

- ### 테이블
    - 외리 캐 하나로 양쪽 조인 가능 
    - 방향이라는 개념이 없음
    
- ### 객체
    - 참조용 필드가 있는 쪽으로만 참조 가느 
    - 한쪽만 참조하면 단방향
    - 양쪽이 서로 참조하면 양방향(정확히 말하면.. 서로 다른 단방향 2개)
    
<br>

## `연관관계의 주인`

- 테이블은 `외래 키 하나`로 두 테이블이 연관관계를 맺음

- 객체 양방향 관계는 A->B, B->A 처럼 참조가 2군데

- 객체 양방향 관계는 참조가 2군데 있음. 둘 중 테이블의 외래 키를 관리할 곳을 지정해야 함

- `연관관계의 주인: 외래 키를 관리하는 참조`

- `주인의 반대편: 외래 키에 영향을 주지 않음, 단순 조회만 가능`

<br> <br>

## `다대일[N:1]`

<img width="482" alt="스크린샷 2021-07-20 오후 3 42 23" src="https://user-images.githubusercontent.com/45676906/126273963-360f13ed-c05e-458c-bee1-cdb76331cd3f.png">

- `다(Many)` 쪽에 해당하는 곳에 외래키가 위치하고 있음

<br> <br>

## `다대일 양방향`

<img width="449" alt="스크린샷 2021-07-20 오후 3 45 15" src="https://user-images.githubusercontent.com/45676906/126274274-c5b195bc-2523-4060-9781-1f51d47132f6.png">


```java
@Entity
public class Member {

    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    @Column(name = "MEMBER_ID")
    private Long id;

    @Column(name = "USERNAME")
    private String username;

    @ManyToOne
    @JoinColumn(name = "TEAM_ID")
    private Team team;
}
```

```java
@Entity
public class Team {

    @Id
    @GeneratedValue
    @Column(name = "TEAM_ID")
    private Long id;

    private String name;

    @OneToMany(mappedBy = "team")
    private List<Member> members = new ArrayList<>();
}
```

- 외래키를 가지고 있는 Member에 `연관 관계 주인`에 해당하도록 매핑을 걸어줌

- 양방향으로 할 거라면 `mappedBy`를 사용해서 함
