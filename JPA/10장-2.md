## `경로 표현식`

경로 표현힉이라는 것은 쉽게 이야기해서 `.`을 찍어 객체 그래프를 탐색하는 것입니다. 

```sql
SELECT m.username
FROM Member m
JOIN m.team t
JOIN m.orders o
WHERE t.nmae = '팀A'
```

여기서 m.username, m.team, m.orders, t.name 모두 경로 표현식을 사용한 예입니다. 

<br> <br>

## `경로 표현식 용어 정리`

### 상태 필드

- 단순히 값을 저장하기 위한 필드

<br>

### 연관 필드

- 연관관계를 위한 필드
- 단일 값 연관 필드: 대상이 엔티티일 때
- 컬렉션 값 연관 필드: 대상이 컬렉션일 때

<br> <br>

## `경로 표현식 특징`

- 상태 필드: 경로 탐색의 끝입니다. 더는 탐색할 수 없습니다. 
- 단일 값 연관 경로: `묵시적으로 내부 조인`이 일어납니다. 단일 값 연관 경로는 계속 탐색할 수 있습니다. 

<br>

![스크린샷 2021-09-20 오후 9 07 26](https://user-images.githubusercontent.com/45676906/133999476-d60456da-6273-49ec-b0fc-e615fbdf5948.png)

Member와 Team의 연관관계는 `N:1`인데요. 여기서 위와 같이 Member에서 Team을 찾아오는 JPQL을 적으면 어떤 쿼리가 나가게 될까요?

<br>

![스크린샷 2021-09-20 오후 9 09 06](https://user-images.githubusercontent.com/45676906/133999755-cbac564f-325a-4134-ab59-cea2903881c0.png)

객체 입장에서는 Member에서 Team을 조회한 것이지만 DB 입장에서는 Member에서 Team을 조인하려면 내부적으로 `inner join`을 해서 가져와야 한다는 것을 알 수 있습니다. 이것을 `묵시적 내부 조인이 일어난다` 라고 합니다. 즉, 개발을 할 때 조심히 써야 한다는 것을 알 수 있습니다. 

- 컬렉션 값 연관 경로: `묵시적으로 내부 조인`이 일어납니다. 더는 탐색할 수 없습니다. 

<br> <br>

## `페치 조인`

페치 조인은 SQL에서 이야기하는 조인의 종류는 아니고 JPQL에서 `성능 최적화`를 위해 제공하는 기능입니다. 연관된 엔티티나 `컬렉션을 SQL 한 번에 조회하는 기능`입니다.

<br> <br>

## `엔티티 페치 조인`

페치 조인을 사용해서 회원 엔티티를 조회하면서 연관된 팀 엔티티도 함께 조회하는 JPQL을 보겠습니다. 

```sql
SELECT m FROM MEmber m 
JOIN fetch m.team
```

위의 예제를 보면 JOIN 다음에 `fetch`를 적은 것을 볼 수 있습니다. 이렇게 하면 연관된 엔티티나 컬렉션을 함께 조회하는데 여기서는 회원과 팀을 함께 조회합니다. 

<img width="1240" alt="스크린샷 2021-09-20 오후 9 22 58" src="https://user-images.githubusercontent.com/45676906/134001534-992e11ba-8146-4fc0-952c-aa47ca8e605a.png">

